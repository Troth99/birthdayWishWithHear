
Частиците и формата на сърцето се създават чрез комбинация от геометрия, математика и анимация. Нека обясня стъпка по стъпка как се случва всичко:

1. Създаване на точки върху сърце
Формата на сърцето се определя от математическа формула, която описва координатите на точки върху тази форма.

Функцията pointOnHeart(t) връща точка на сърцето в зависимост от параметъра t:

javascript
Copy code
function pointOnHeart(t) {
    return new Point(
        160 * Math.pow(Math.sin(t), 3),  // x координата
        130 * Math.cos(t) - 50 * Math.cos(2 * t) - 
        20 * Math.cos(3 * t) - 10 * Math.cos(4 * t) + 25 // y координата
    );
}
Как работи:
t варира от -π до π (т.е. пълна окръжност).
Уравненията за x и y създават точки, които очертават сърце, когато се свържат.
Всяка точка се връща като обект от типа Point.

2. Създаване на частици
Частиците се създават в render() функцията. За всяка частица:

Генерира се случайна точка върху сърцето, използвайки pointOnHeart().

Изчислява се началната позиция на частицата:

javascript
Copy code
let pos = pointOnHeart(Math.PI - 2 * Math.PI * Math.random());
Това създава частица върху произволна точка от сърцето.

Посоката и скоростта на частицата се изчисляват:

javascript
Copy code
let dir = pos.clone().length(settings.particles.velocity);
Частицата се добавя към ParticlePool, като се задават началните ѝ позиции и скорост:

javascript
Copy code
particles.add(
    canvas.width / 2 + pos.x,  // Център на платното + x на частицата
    canvas.height / 2 - pos.y, // Център на платното - y на частицата
    dir.x,                    // Скорост по x
    -dir.y                    // Скорост по y
);
3. Движение на частиците
Частиците се движат чрез функцията update() в класа Particle:

Позицията им се актуализира на база скорост и ускорение:
javascript
Copy code
this.position.x += this.velocity.x * deltaTime;
this.position.y += this.velocity.y * deltaTime;
this.velocity.x += this.acceleration.x * deltaTime;
this.velocity.y += this.acceleration.y * deltaTime;
Тяхното движение създава илюзията, че частиците се разпръскват от сърцето.

4. Рисуване на частиците
Всяка частица се рисува върху платното с функцията draw():

Размерът на частицата намалява с времето:

javascript
Copy code
let size = image.width * ease(this.age / settings.particles.duration);
Прозрачността също намалява с времето:

javascript
Copy code
context.globalAlpha = 1 - this.age / settings.particles.duration;
Частиците са представени като изображение (в случая – цветен кръг), което е предварително създадено.

5. Анимация
Частиците се създават и анимират във времето чрез requestAnimationFrame() в render():

Всяка итерация добавя нови частици.
Старите частици се актуализират и рисуват.
Всичко се изчиства и се рисува отново, създавайки ефект на движение.
Как частиците образуват сърце?
Формата на сърцето идва от функцията pointOnHeart().
Позициите на началните точки на частиците следват тази форма.
Частиците се разпръскват от сърцето, но тяхната първоначална позиция следва уравнението на сърцето.

